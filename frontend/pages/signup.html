<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sign up - LinkUIU</title>
  <link rel="stylesheet" href="../assets/css/style.css" />
  <script defer src="../assets/js/main.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const form = document.getElementById('signup-form');
      const err = document.getElementById('error');
      const msg = document.getElementById('msg');
      const userTypeSelect = document.getElementById('user_type');
      const batchField = document.getElementById('batch_field');
      
      // Show/hide batch field based on user type
      userTypeSelect.addEventListener('change', (e) => {
        if (e.target.value === 'student') {
          batchField.style.display = 'block';
          batchField.querySelector('select').required = true;
        } else {
          batchField.style.display = 'none';
          batchField.querySelector('select').required = false;
        }
      });
      
      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        err.textContent = '';
        msg.textContent = '';
        const name = form.elements['name'].value.trim();
        const email = form.elements['email'].value.trim();
        const student_id = form.elements['student_id'].value.trim();
        const password = form.elements['password'].value;
        const user_type = form.elements['user_type'].value;
        const department_id = form.elements['department_id'].value;
        const batch_id = form.elements['batch_id'].value;
        
        try {
          LinkUIU.setLoading(true);
          const payload = { 
            name, 
            email, 
            student_id, 
            password, 
            user_type, 
            department_id 
          };
          
          // Only include batch_id if it's provided (for students)
          if (batch_id) {
            payload.batch_id = batch_id;
          }
          
          const data = await LinkUIU.api('/auth/signup', { method: 'POST', body: payload });
          msg.textContent = 'Account created. Redirecting to login...';
          LinkUIU.showToast('Account created', 'success');
          setTimeout(() => location.href = './login.html', 1200);
        } catch (e) {
          err.textContent = e.message;
          LinkUIU.showToast(e.message, 'error');
        } finally { LinkUIU.setLoading(false); }
      });
    });
  </script>
  <style> 
    body { background: linear-gradient(180deg,#fff,#fff8f1); } 
    
    .horizontal-card {
      display: flex;
      max-width: 650px;
      width: 100%;
      min-height: 450px;
      margin: 0 auto;
    }
    
    .card-left {
      flex: 1;
      background: linear-gradient(135deg, #FF6F00, #F57C00);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 25px;
      border-radius: 20px 0 0 20px;
    }
    
    .card-left .brand {
      text-align: center;
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    
    .card-left .brand-badge {
      font-size: 4rem;
      margin-bottom: 20px;
    }
    
    .card-left .subtitle {
      font-size: 1.2rem;
      opacity: 0.9;
      color: white !important;
    }
    
    .card-right {
      flex: 1;
      padding: 25px;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
    
    .card-right .field {
      margin-bottom: 15px;
    }
    
    .card-right .btn {
      margin-top: 10px;
    }
    
    @media (max-width: 768px) {
      .horizontal-card {
        flex-direction: column;
        max-width: 350px;
        min-height: auto;
      }
      
      .card-left {
        border-radius: 20px 20px 0 0;
        padding: 20px;
      }
      
      .card-right {
        padding: 20px;
      }
    }
  </style>
</head>
<body>
  <header class="header">
    <div class="header-inner">
      <div class="brand-left">
        <img class="uiu-logo" src="../assets/images/uiu_logo.png?v=2" alt="UIU logo" />
      </div>
      <div class="brand-center"></div>
      <div class="brand-right">
        <img class="linkuiu-logo" src="../assets/images/linkuiu_logo.png" alt="LinkUIU logo" onclick="location.href='./landing.html'" style="cursor: pointer;" />
      </div>
      <button class="hamburger" aria-label="Toggle mobile menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <nav class="nav">
        <span class="nav-link" onclick="location.href='./landing.html'" style="cursor: pointer;">Home</span>
        <span class="nav-link" onclick="location.href='jobs.html'" style="cursor: pointer;">Jobs</span>
        <span class="nav-link" onclick="location.href='connections.html'" style="cursor: pointer;">Connect</span>
        <span class="nav-link" onclick="location.href='messages.html'" style="cursor: pointer;">Messages</span>
        <span class="nav-link" onclick="location.href='search.html'" style="cursor: pointer;">Directory</span>
        <span class="nav-link" onclick="location.href='profile.html'" style="cursor: pointer;">Profile</span>
        <a href="login.html" class="btn btn-primary">Login</a>
      </nav>
    </div>
    
    <!-- Mobile Navigation -->
    <div class="mobile-nav">
      <div class="mobile-nav-content">
        <div class="mobile-nav-header">
          <img class="linkuiu-logo" src="../assets/images/linkuiu_logo.png" alt="LinkUIU logo" style="height: 30px;" />
          <button class="mobile-nav-close" aria-label="Close mobile menu">&times;</button>
        </div>
        <div class="mobile-nav-links">
          <span onclick="location.href='./landing.html'; closeMobileMenu();" style="cursor: pointer;">Home</span>
          <span onclick="location.href='jobs.html'; closeMobileMenu();" style="cursor: pointer;">Jobs</span>
          <span onclick="location.href='connections.html'; closeMobileMenu();" style="cursor: pointer;">Connect</span>
          <span onclick="location.href='messages.html'; closeMobileMenu();" style="cursor: pointer;">Messages</span>
          <span onclick="location.href='search.html'; closeMobileMenu();" style="cursor: pointer;">Directory</span>
          <span onclick="location.href='profile.html'; closeMobileMenu();" style="cursor: pointer;">Profile</span>
          <a href="login.html" class="btn btn-primary">Login</a>
        </div>
      </div>
    </div>
  </header>
  <div class="centered">
    <div class="card horizontal-card">
      <div class="card-left">
        <div class="brand">
          <div class="brand-badge"></div>
          <div>
            <div class="subtitle">Join the UIU community</div>
          </div>
        </div>
      </div>
      <div class="card-right">
        <form id="signup-form">
        <div class="field">
          <label class="label">I am a</label>
          <select class="input" name="user_type" id="user_type" required>
            <option value="">Select your status</option>
            <option value="student">Current Student</option>
            <option value="alumni">Alumni</option>
          </select>
        </div>
        <div class="field">
          <label class="label">Full name</label>
          <input class="input" name="name" placeholder="Your Name" required />
        </div>
        <div class="field">
          <label class="label">UIU Email</label>
          <input class="input" name="email" placeholder="name@bscse.uiu.ac.bd" required />
        </div>
        <div class="field">
          <label class="label">Student ID</label>
          <input class="input" name="student_id" placeholder="011XXXXXXX" pattern="01\d{8}" required />
        </div>
        <div class="field">
          <label class="label">Department</label>
          <select class="input" name="department_id" required>
            <option value="">Select Department</option>
            <option value="1">CSE (Computer Science & Engineering)</option>
            <option value="2">EEE (Electrical & Electronic Engineering)</option>
            <option value="3">BBA (Business Administration)</option>
            <option value="4">CE (Civil Engineering)</option>
            <option value="5">ECO (Economics)</option>
            <option value="6">EDS (English & Development Studies)</option>
            <option value="7">English (English Language & Literature)</option>
            <option value="8">BGE (Biotechnology & Genetic Engineering)</option>
            <option value="9">Pharmacy</option>
          </select>
        </div>
        <div class="field" id="batch_field" style="display: none;">
          <label class="label">Batch/Trimester</label>
          <select class="input" name="batch_id">
            <option value="">Select Batch (Optional for Alumni)</option>
            <option value="1">171</option>
            <option value="2">172</option>
            <option value="3">173</option>
            <option value="4">181</option>
            <option value="5">182</option>
            <option value="6">183</option>
            <option value="7">191</option>
            <option value="8">192</option>
            <option value="9">193</option>
            <option value="10">201</option>
            <option value="11">202</option>
            <option value="12">203</option>
            <option value="13">211</option>
            <option value="14">212</option>
            <option value="15">213</option>
            <option value="16">221</option>
            <option value="17">222</option>
            <option value="18">223</option>
            <option value="19">241</option>
            <option value="20">242</option>
            <option value="21">243</option>
            <option value="22">251</option>
            <option value="23">252</option>
          </select>
        </div>
        <div class="field">
          <label class="label">Password</label>
          <input class="input" type="password" name="password" placeholder="At least 8 chars, letters and numbers" required />
        </div>
        <button class="btn btn-primary" type="submit">Create account</button>
        <div id="error" class="error"></div>
        <div id="msg" class="success"></div>
        <div class="mt-16">Already have an account? <a href="./login.html">Login</a></div>
        </form>
      </div>
    </div>
  </div>
</body>
</html>

