<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dashboard - LinkUIU</title>
  <link rel="stylesheet" href="../assets/css/style.css?v=2" />
  <script defer src="../assets/js/main.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', async () => {
      if (!LinkUIU.getToken()) {
        location.href = './login.html';
        return;
      }
      
      try {
        // Fetch user data to get user_type
        const userData = await LinkUIU.api('/auth/me', { auth: true });
        const user = userData || JSON.parse(localStorage.getItem('auth_user')||'{}');
        
        // Update welcome message with user type
        const welcomeElement = document.getElementById('welcome');
        const userTypeBadge = document.getElementById('user-type-badge');
        
        if (user.user_type === 'alumni') {
          welcomeElement.innerHTML = `Welcome back, <strong>${user.name || 'Alumni'}</strong>`;
          userTypeBadge.innerHTML = 'ðŸŒŸ Alumni';
          userTypeBadge.className = 'user-type-badge alumni';
        } else {
          welcomeElement.innerHTML = `Welcome, <strong>${user.name || 'Student'}</strong>`;
          userTypeBadge.innerHTML = 'ðŸŽ“ Student';
          userTypeBadge.className = 'user-type-badge student';
        }
        
        // Store updated user data
        localStorage.setItem('auth_user', JSON.stringify(user));
      } catch (error) {
        console.error('Error fetching user data:', error);
        const user = JSON.parse(localStorage.getItem('auth_user')||'{}');
        document.getElementById('welcome').textContent = `Welcome, ${user.name || 'UIU Member'}`;
      }
    });
  </script>
</head>
<body>
  <header class="header">
    <div class="header-inner">
      <div class="brand-left">
        <img class="uiu-logo" src="../assets/images/uiu_logo.png?v=2" alt="UIU logo" />
      </div>
      <div class="brand-center"></div>
      <div class="brand-right">
        <img class="linkuiu-logo" src="../assets/images/linkuiu_logo.png" alt="LinkUIU logo" onclick="location.href='./dashboard.html'" style="cursor: pointer;" />
      </div>
      <button class="hamburger" aria-label="Toggle mobile menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <nav class="nav">
        <span class="nav-link" onclick="location.href='./dashboard.html'" style="cursor: pointer;">Home</span>
        <span class="nav-link" onclick="location.href='./profile.html'" style="cursor: pointer;">Profile</span>
        <span class="nav-link" onclick="location.href='./jobs.html'" style="cursor: pointer;">Jobs</span>
        <span class="nav-link" onclick="location.href='./applications.html'" style="cursor: pointer;">My Applications</span>
        <span class="nav-link" onclick="location.href='./connections.html'" style="cursor: pointer;">Connections</span>
        <span class="nav-link" onclick="location.href='./messages.html'" style="cursor: pointer;">Messages</span>
        <span class="nav-link" onclick="location.href='./search.html'" style="cursor: pointer;">Search</span>
        <button class="btn btn-primary" onclick="localStorage.clear(); location.href='./login.html'">Logout</button>
      </nav>
    </div>
    
    <!-- Mobile Navigation -->
    <div class="mobile-nav">
      <div class="mobile-nav-content">
        <div class="mobile-nav-header">
          <img class="linkuiu-logo" src="../assets/images/linkuiu_logo.png" alt="LinkUIU logo" style="height: 30px;" />
          <button class="mobile-nav-close" aria-label="Close mobile menu">&times;</button>
        </div>
        <div class="mobile-nav-links">
          <span onclick="location.href='./dashboard.html'; closeMobileMenu();" style="cursor: pointer;">Home</span>
          <span onclick="location.href='./profile.html'; closeMobileMenu();" style="cursor: pointer;">Profile</span>
          <span onclick="location.href='./jobs.html'; closeMobileMenu();" style="cursor: pointer;">Jobs</span>
          <span onclick="location.href='./applications.html'; closeMobileMenu();" style="cursor: pointer;">My Applications</span>
          <span onclick="location.href='./connections.html'; closeMobileMenu();" style="cursor: pointer;">Connections</span>
          <span onclick="location.href='./messages.html'; closeMobileMenu();" style="cursor: pointer;">Messages</span>
          <span onclick="location.href='./search.html'; closeMobileMenu();" style="cursor: pointer;">Search</span>
          <button class="btn btn-primary" onclick="localStorage.clear(); location.href='./login.html'; closeMobileMenu();">Logout</button>
        </div>
      </div>
    </div>
  </header>
  <div class="container">
    <div class="welcome-section">
      <h2 id="welcome" class="mt-24"></h2>
      <div id="user-type-badge" class="user-type-badge"></div>
    </div>
    <div class="mt-24 row">
      <a class="btn btn-primary" href="./profile.html">Edit Profile</a>
      <a class="btn btn-primary" href="./jobs.html">Browse Jobs</a>
      <a class="btn btn-primary" href="./applications.html">My Applications</a>
    </div>
  </div>
</body>
</html>

